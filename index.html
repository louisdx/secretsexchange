<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>Secret Exchange</title>
    <link rel="stylesheet" type="text/css" href="default.css">
    <script type="text/javascript" src="BigInt.js"></script>
    <script type="text/javascript" src="sexchange-core.js"></script>
    <script type="text/javascript" src="sexchange-ui.js"></script>
  </head>

  <body>

    <h1>Secrets Exchange</h1>

    <p>You are one of Alice and Bob, and you want to exchange secret
    messages with the other partner. Alice initiates the exchange with
    a handshake; Bob responds to the handshake. Once both sides have
    exchanged a token (which can safely be transmitted in public),
    they have a shared secret which nobody else knows and which they
    can use to exchange encrypted messages.</p>

    <p>You may also like to visit the <a href="https://github.com/louisdx/secretsexchange">GitHub project page</a>
    where you can obtain an offline application that does the same thing as this website, or visit the
    <a href="index-OLD.html">original version</a> of this page.</p>

    <form action="" style="float: left; margin-right: 1em;">
      <fieldset>
      <legend>Alice (initiates the handshake)</legend>
      <table>
        <tbody>
          <tr>
            <th>Step 1:<br>Enter a number</th>
            <td><input type="text" name="in_a" id="in_a"></td>
            <td><input type="button" name="but_rnda" id="but_rnda" value="random"> <input type="button" id="go_a" value="done"></td>
          </tr>
          <tr>
            <th>Step 2:<br>Send this to Bob</th>
            <td><input type="text" name="in_ga" id="in_ga"></td>
            <td>make sure this is not &ldquo;1&rdquo;</td>
          </tr>
          <tr>
            <th>Step 3:<br>Paste Bob&rsquo;s number</th>
            <td><input name="in_put_a" id="in_put_a" type="text"></td>
            <td><input type="button" id="but_ra" value="done"></td>
          </tr>
          <tr>
            <th>Step 4: Communicate</th>
            <td colspan="2"><a href="#encrypt">start encrypting/decrypting</a></td>
          </tr>
        </tbody>
      </table>
      </fieldset>
    </form>

    <form action="">
      <fieldset>
      <legend>Bob (responds to the handshake)</legend>
      <table>
        <tbody>
          <tr>
            <th>Step 1:<br>Paste Alice&rsquo;s number</th>
            <td><input name="in_put_b" id="in_put_b" type="text"></td>
            <td><input type="button" id="but_rb" value="done"></td>
          </tr>
          <tr>
            <th>Step 2:<br>Enter a number</th>
            <td><input type="text" name="in_b" id="in_b"></td>
            <td><input type="button" name="but_rndb" id="but_rndb" value="random"> <input type="button" id="go_b" value="done"></td>
          </tr>
          <tr>
            <th>Step 3:<br>Send this to Alice</th>
            <td><input type="text" name="in_gb" id="in_gb"></td>
            <td>make sure this is not &ldquo;1&rdquo;</td>
          </tr>
          <tr>
            <th>Step 4: Communicate</th>
            <td colspan="2"><a href="#encrypt">start encrypting/decrypting</a></td>
          </tr>
        </tbody>
      </table>
      </fieldset>
    </form>

    <form action="" id="encrypt">
      <fieldset>
      <legend>Encrypt/decrypt messages:</legend>
      <p>The plain-text message must be at most 99 characters long. Please check whether &ldquo;decrypt&rdquo;
      actually reproduces the plain text before sending it to the other party.</p>
      <table>
        <tbody>
          <tr>
            <th>Send message</th>
            <td><input id="in_pt" type="text" name="in_pt" size="99"></td>
            <td><input type="button" id="go_enc" name="go_enc" value="Encrypt"></td>
          </tr>
          <tr>
            <th>Read message</th>
            <td><input id="in_et" type="text" name="in_et" size="99"></td>
            <td><input type="button" id="go_dec" name="go_dec" value="Decrypt"></td>
          </tr>
        </tbody>
      </table>
      </fieldset>
    </form>

    <h2>Some background information</h2>

    <p>Your own number (Alice&rsquo;s Step 1 and Bob&rsquo;s Step 2) is your own, private
    secret that <em>nobody</em> else knows or must know. The shared secret (displayed below)
    is known only to you and your partner, but is and must never be transmitted.</p>
    <p>If you make a copy of the shared secret, or of your private secret and the other party&rsquo;s
    public handshake, you can later resume decrypting and encrypting messages from the same session.
    (To encrypt/decrypt messages with a user-defined shared secret, please use the <a href="index-OLD.html">old
    website</a>.)</p>

    <form action="">
      <fieldset>
      <legend>Internal data (for information only)</legend>
      <table>
        <tbody>
          <tr>
            <th><var>p</var></th>
            <td><input type="text" name="in_p" id="in_p" readonly="readonly"></td>
            <td>a (large) prime</td>
          </tr>
          <tr>
            <th><var>g</var></th>
            <td><input type="text" name="in_g" id="in_g" readonly="readonly"></td>
            <td>a subgroup generator in (Z/<var>p</var>Z)<sup>&times;</sup></td>
          </tr>
          <tr>
            <th><var>g</var><sup><var>ab</var></sup></th>
            <td><input type="text" name="in_g" id="out_gab" readonly="readonly"></td>
            <td>the shared secret</td>
          </tr>
        </tbody>
      </table>
      </fieldset>
    </form>

  </body>

</html>
