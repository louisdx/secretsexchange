<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
  <head>
    <title>Secret Exchange</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <link rel="stylesheet" type="text/css" href="default.css">
    <script type="text/javascript" src="BigInt.js"></script>
    <script type="text/javascript" src="sexchange.js"></script>
  </head>

  <body>

    <h1>Secret Exchange</h1>

    <h2>Handshake</h2>

    <form action="" style="float: left; margin: 0 2em 0 0">
      <fieldset>
      <legend>The public data</legend>
      <table>
        <tbody>
          <tr>
            <th style="width: 2em;"><var>g</var></th>
            <td><input type="text" name="in_g" id="in_g" readonly="readonly"></td>
          </tr>
          <tr>
            <th><var>p</var></th>
            <td><input type="text" name="in_p" id="in_p" readonly="readonly"></td>
          </tr>
          <tr>
            <th><var>g</var><sup><var>a</var></sup></th>
            <td><input type="text" name="in_ga" id="in_ga"></td>
          </tr>
          <tr>
            <th><var>g</var><sup><var>b</var></sup></th>
            <td><input type="text" name="in_gb" id="in_gb"></td>
          </tr>
        </tbody>
      </table>
      </fieldset>
    </form>

    <form action="">
      <fieldset>
      <legend>Alice's private data</legend>
      <table>
        <tbody>
          <tr>
            <th style="width: 8em;"><var>a</var> (secret)</th>
            <td><input type="text" name="in_a" id="in_a"></td>
          </tr>
        </tbody>
      </table>
      </fieldset>
    </form>

    <form action="">
      <fieldset>
      <legend>Bob's private data</legend>
      <table>
        <tbody>
          <tr>
            <th style="width: 8em;"><var>b</var> (secret)</th>
            <td><input type="text" name="in_b" id="in_b"></td>
          </tr>
        </tbody>
      </table>
      </fieldset>
    </form>

    <form action="">
      <fieldset>
      <legend>The shared secret</legend>
      <table>
        <tbody>
          <tr>
            <th style="width: 8em;"><var>g</var><sup><var>ab</var></sup> (secret)</th>
            <td><input type="text" name="out_gab" id="out_gab"></td>
          </tr>
        </tbody>
      </table>
      </fieldset>
    </form>

    <p><strong>If you are Alice:</strong> Enter a secret <label for="in_a"><var>a</var></label> and
    then transmit <var>g</var><sup><var>a</var></sup> to Bob.
    <input type="button" id="go_a" value="1. I am Alice; initiate."></p>

    <p><strong>If you are Bob:</strong> Wait for the data from Alice, read it, and enter
    a secret <label for="in_b"><var>b</var></label>. Then send
    <label for="in_gb"><var>g</var><sup><var>b</var></sup></label> to Bob and compute the shared secret.
    <input type="button" id="go_b" value="4. I am Bob; make shared secret."></p>

    <p><strong>Alice again:</strong> Read Bob's token
    <label for="in_gb"><var>g</var><sup><var>b</var></sup></label> below and compute the shared secret.</p>

    <form action="">
      <fieldset>
      <legend>Input/Output</legend>
      <table>
        <tbody>
          <tr>
            <th style="width: 5em;">Input</th>
            <td style="width: 15em;"><input name="in_put" id="in_put" type="text"></td>
            <td><input type="button" id="but_rb" value="3. Read as Bob">
                <input type="button" id="but_ra" value="6. Read as Alice and compute shared secret"></td>
          </tr>
          <tr>
            <th>Output</th>
            <td><input name="out_put" id="out_put" type="text"></td>
            <td>2. Send to Bob. 5. Send to Alice.</td>
          </tr>
        </tbody>
      </table>
      </fieldset>
    </form>

    <h2>Talk</h2>

    <form action="">
      <table>
        <tbody>
          <tr>
            <th>Plaintext (secret)</th>
            <td><input name="in_pt" id="in_pt" size="50" type="text"></td>
            <td><input type="button" id="go_enc" name="go_enc" value="Encrypt"></td>
          </tr>
          <tr>
            <th>Encrypted (public)</th>
            <td><input name="in_et" id="in_et" size="50" type="text"></td>
            <td><input type="button" id="go_dec" name="go_dec" value="Decrypt"></td>
          </tr>
        </tbody>
      </table>
    </form>

  </body>
</html>
